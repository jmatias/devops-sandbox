apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: argocd

resources:
  - ../../base
  - argocd-vpa.yaml
  - github-oauth-secret.yaml

patches:

  - path: patch-application-controller.yaml
    target:
      kind: StatefulSet
      name: argocd-application-controller
      namespace: argocd

  - path: argocd-cmd-params-cm.yaml
    target:
      name: argocd-cmd-params-cm

  - path: argocd-cm.yaml
    target:
      name: argocd-cm

  - path: ingress.yaml
    target:
      name: argocd-server-ingress

  - path: patch-server-deployment.yaml
    target:
      name: argocd-server
      kind: Deployment

  - path: repo-server-deployment.yaml
    target:
      name: argocd-repo-server
      kind: Deployment

  - path: redis.yaml
    target:
      name: argocd-redis
      kind: Deployment
